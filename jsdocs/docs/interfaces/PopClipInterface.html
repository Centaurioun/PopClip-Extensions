<!DOCTYPE html><html class="default no-js"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>PopClipInterface | PopClip Extensions JavaScript Reference</title><meta name="description" content="Documentation for PopClip Extensions JavaScript Reference"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script async src="../assets/search.js" id="search-script"></script></head><body><header><div class="tsd-page-toolbar"><div class="container"><div class="table-wrap"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget search no-caption">Search</label><input type="text" id="tsd-search-field"/></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">PopClip Extensions JavaScript Reference</a></div><div class="table-cell" id="tsd-widgets"><div id="tsd-filter"><a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a><div class="tsd-filter-group"><div class="tsd-select" id="tsd-filter-visibility"><span class="tsd-select-label">All</span><ul class="tsd-select-list"><li data-value="public">Public</li><li data-value="protected">Public/Protected</li><li data-value="private" class="selected">All</li></ul></div> <input type="checkbox" id="tsd-filter-inherited" checked/><label class="tsd-widget" for="tsd-filter-inherited">Inherited</label></div></div><a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a></div></div></div></div><div class="tsd-page-title"><div class="container"><ul class="tsd-breadcrumb"><li><a href="../modules.html">PopClip Extensions JavaScript Reference</a></li><li><a href="PopClipInterface.html">PopClipInterface</a></li></ul><h1>Interface PopClipInterface</h1></div></div></header><div class="container container-main"><div class="row"><div class="col-8 col-content"><section class="tsd-panel tsd-comment"><div class="tsd-comment tsd-typography"><div class="lead">
<p><code>PopClipInterface</code> defines the methods and properties of the global <code>popclip</code> object.</p>
</div></div></section><section class="tsd-panel tsd-hierarchy"><h3>Hierarchy</h3><ul class="tsd-hierarchy"><li><span class="target">PopClipInterface</span></li></ul></section><section class="tsd-panel-group tsd-index-group"><h2>Index</h2><section class="tsd-panel tsd-index-panel"><div class="tsd-index-content"><section class="tsd-index-section "><h3>Methods</h3><ul class="tsd-index-list"><li class="tsd-kind-method tsd-parent-kind-interface"><a href="PopClipInterface.html#copyText" class="tsd-kind-icon">copy<wbr/>Text</a></li><li class="tsd-kind-method tsd-parent-kind-interface"><a href="PopClipInterface.html#pasteText" class="tsd-kind-icon">paste<wbr/>Text</a></li><li class="tsd-kind-method tsd-parent-kind-interface"><a href="PopClipInterface.html#pressKey" class="tsd-kind-icon">press<wbr/>Key</a></li></ul></section><section class="tsd-index-section "><h3>Properties</h3><ul class="tsd-index-list"><li class="tsd-kind-property tsd-parent-kind-interface"><a href="PopClipInterface.html#modifierKeys" class="tsd-kind-icon">modifier<wbr/>Keys</a></li></ul></section></div></section></section><section class="tsd-panel-group tsd-member-group "><h2>Methods</h2><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-interface"><a name="copyText" class="tsd-anchor"></a><h3>copy<wbr/>Text</h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-interface"><li class="tsd-signature tsd-kind-icon">copy<wbr/>Text<span class="tsd-signature-symbol">(</span>text<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">void</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"></aside><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>text: <span class="tsd-signature-type">string</span></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">void</span></h4></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-interface"><a name="pasteText" class="tsd-anchor"></a><h3>paste<wbr/>Text</h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-interface"><li class="tsd-signature tsd-kind-icon">paste<wbr/>Text<span class="tsd-signature-symbol">(</span>text<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span>, restore<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">boolean</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">void</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"></aside><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>text: <span class="tsd-signature-type">string</span></h5></li><li><h5><span class="tsd-flag ts-flagOptional">Optional</span> restore: <span class="tsd-signature-type">boolean</span></h5></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">void</span></h4></li></ul></section><section class="tsd-panel tsd-member tsd-kind-method tsd-parent-kind-interface"><a name="pressKey" class="tsd-anchor"></a><h3>press<wbr/>Key</h3><ul class="tsd-signatures tsd-kind-method tsd-parent-kind-interface"><li class="tsd-signature tsd-kind-icon">press<wbr/>Key<span class="tsd-signature-symbol">(</span>key<span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type">number</span>, modifiers<span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">)</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">void</span></li></ul><ul class="tsd-descriptions"><li class="tsd-description"><aside class="tsd-sources"></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>Simulate a key press by the user. The key press delivered at the current app level, not at the OS level. This means PopClip
is not able to trigger global keyboard shortcuts. For example, PopClip can trigger ⌘B for &quot;bold&quot; (or whatever it means in the
current app) but not ⌘Tab for &quot;switch app&quot;.</p>
</div><div><p>Some key code and modifier constants are available in <a href="../modules.html#Util">Util</a>.<a href="UtilInterface.html#Constant">Constant</a>.</p>
<p><a href="http://stackoverflow.com/questions/3202629/where-can-i-find-a-list-of-mac-virtual-key-codes">More key codes (StackOverflow)</a></p>

<a href="#example" id="example" style="color: inherit; text-decoration: none;">
  <h4>Example</h4>
</a>
<pre><code class="language-js"><span class="hl-4">// press the key combo ⌘B</span><br/><span class="hl-2">popclip</span><span class="hl-1">.</span><span class="hl-5">pressKey</span><span class="hl-1">(</span><span class="hl-3">&#39;B&#39;</span><span class="hl-1">, </span><span class="hl-2">Util</span><span class="hl-1">.</span><span class="hl-2">Constant</span><span class="hl-1">.</span><span class="hl-6">MODIFIER_COMMAND</span><span class="hl-1">)</span><br/><span class="hl-4">// press the key combo ⌥⌘H</span><br/><span class="hl-2">popclip</span><span class="hl-1">.</span><span class="hl-5">pressKey</span><span class="hl-1">(</span><span class="hl-3">&#39;H&#39;</span><span class="hl-1">, </span><span class="hl-2">Util</span><span class="hl-1">.</span><span class="hl-2">Constant</span><span class="hl-1">.</span><span class="hl-6">MODIFIER_OPTION</span><span class="hl-1">|</span><span class="hl-2">Util</span><span class="hl-1">.</span><span class="hl-2">Constant</span><span class="hl-1">.</span><span class="hl-6">MODIFIER_COMMAND</span><span class="hl-1">)</span><br/><span class="hl-4">// press the return key</span><br/><span class="hl-2">popclip</span><span class="hl-1">.</span><span class="hl-5">pressKey</span><span class="hl-1">(</span><span class="hl-2">Util</span><span class="hl-1">.</span><span class="hl-2">Constant</span><span class="hl-1">.</span><span class="hl-6">KEY_RETURN</span><span class="hl-1">)</span>
</code></pre>
</div></div><h4 class="tsd-parameters-title">Parameters</h4><ul class="tsd-parameters"><li><h5>key: <span class="tsd-signature-type">string</span><span class="tsd-signature-symbol"> | </span><span class="tsd-signature-type">number</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>The key to press. When this parameter is a string, PopClip will look up the key code for the first character in the string,
mapped to the current keyboard layout. When this parameter is a number, PopClip will use that exact key code.</p>
</div></div></li><li><h5><span class="tsd-flag ts-flagOptional">Optional</span> modifiers: <span class="tsd-signature-type">number</span></h5><div class="tsd-comment tsd-typography"><div class="lead">
<p>A bit mask specifiying the modifier keys, if any.</p>
</div></div></li></ul><h4 class="tsd-returns-title">Returns <span class="tsd-signature-type">void</span></h4></li></ul></section></section><section class="tsd-panel-group tsd-member-group "><h2>Properties</h2><section class="tsd-panel tsd-member tsd-kind-property tsd-parent-kind-interface"><a name="modifierKeys" class="tsd-anchor"></a><h3><span class="tsd-flag ts-flagReadonly">Readonly</span> modifier<wbr/>Keys</h3><div class="tsd-signature tsd-kind-icon">modifier<wbr/>Keys<span class="tsd-signature-symbol">:</span> <span class="tsd-signature-type">number</span></div><aside class="tsd-sources"></aside><div class="tsd-comment tsd-typography"><div class="lead">
<p>A bit field representing the modifier keys held when the action was invoked in PopClip.
Constants for the modifiers are given in <a href="../modules.html#Util">Util</a>.<a href="UtilInterface.html#Constant">Constant</a>.</p>
</div><div>
<a href="#example" id="example" style="color: inherit; text-decoration: none;">
  <h4>Example</h4>
</a>
<pre><code class="language-javascript"><span class="hl-4">// test for shift</span><br/><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-2">popclip</span><span class="hl-1">.</span><span class="hl-2">modifierKeys</span><span class="hl-1"> &amp; </span><span class="hl-2">Util</span><span class="hl-1">.</span><span class="hl-2">Constant</span><span class="hl-1">.</span><span class="hl-6">MODIFIER_SHIFT</span><span class="hl-1">) {</span><br/><span class="hl-1">  ...</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">// test for  shift OR option</span><br/><span class="hl-7">if</span><span class="hl-1"> (</span><span class="hl-2">popclip</span><span class="hl-1">.</span><span class="hl-2">modifierKeys</span><span class="hl-1"> &amp; </span><span class="hl-2">Util</span><span class="hl-1">.</span><span class="hl-2">Constant</span><span class="hl-1">.</span><span class="hl-6">MODIFIER_SHIFT</span><span class="hl-1">|</span><span class="hl-2">Util</span><span class="hl-1">.</span><span class="hl-2">Constant</span><span class="hl-1">.</span><span class="hl-6">MODIFIER_OPTION</span><span class="hl-1">) {</span><br/><span class="hl-1">  ...</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-4">// test for shift AND option</span><br/><span class="hl-0">let</span><span class="hl-1"> </span><span class="hl-2">combo</span><span class="hl-1"> = </span><span class="hl-2">Util</span><span class="hl-1">.</span><span class="hl-2">Constant</span><span class="hl-1">.</span><span class="hl-6">MODIFIER_SHIFT</span><span class="hl-1">|</span><span class="hl-2">Util</span><span class="hl-1">.</span><span class="hl-2">Constant</span><span class="hl-1">.</span><span class="hl-6">MODIFIER_OPTION</span><span class="hl-1">;</span><br/><span class="hl-7">if</span><span class="hl-1"> ((</span><span class="hl-2">popclip</span><span class="hl-1">.</span><span class="hl-2">modifierKeys</span><span class="hl-1"> &amp; </span><span class="hl-2">combo</span><span class="hl-1">) === </span><span class="hl-2">combo</span><span class="hl-1">) {</span><br/><span class="hl-1">  ...</span><br/><span class="hl-1">}</span>
</code></pre>
</div></div></section></section></div><div class="col-4 col-menu menu-sticky-wrap menu-highlight"><nav class="tsd-navigation primary"><ul><li class=""><a href="../modules.html">Exports</a></li></ul></nav><nav class="tsd-navigation secondary menu-sticky"><ul><li class="current tsd-kind-interface"><a href="PopClipInterface.html" class="tsd-kind-icon">Pop<wbr/>Clip<wbr/>Interface</a><ul><li class="tsd-kind-method tsd-parent-kind-interface"><a href="PopClipInterface.html#copyText" class="tsd-kind-icon">copy<wbr/>Text</a></li><li class="tsd-kind-property tsd-parent-kind-interface"><a href="PopClipInterface.html#modifierKeys" class="tsd-kind-icon">modifier<wbr/>Keys</a></li><li class="tsd-kind-method tsd-parent-kind-interface"><a href="PopClipInterface.html#pasteText" class="tsd-kind-icon">paste<wbr/>Text</a></li><li class="tsd-kind-method tsd-parent-kind-interface"><a href="PopClipInterface.html#pressKey" class="tsd-kind-icon">press<wbr/>Key</a></li></ul></li></ul></nav></div></div></div><footer class="with-border-bottom"><div class="container"><h2>Legend</h2><div class="tsd-legend-group"><ul class="tsd-legend"><li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li><li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li></ul></div><h2>Settings</h2><p>Theme <select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></p></div></footer><div class="container tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div><script src="../assets/main.js"></script></body></html>